<!-- è£œåŠ©UIå°‚ç”¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ -->
<div class="structure-ui" id="structureUI">
    <!-- Claudeè©•ä¾¡çµæœè¡¨ç¤ºã‚¨ãƒªã‚¢ -->
    <div class="claude-evaluation-section">
        <div class="section-header">
            <h3>ğŸ§  Claudeè©•ä¾¡çµæœ</h3>
            <div class="section-actions">
                <button class="btn btn-sm btn-primary" onclick="triggerClaudeEvaluation()" id="evaluate-btn">
                    ğŸ”„ å†è©•ä¾¡
                </button>
                <span class="auto-update-status" style="display: none;">è©•ä¾¡ä¸­...</span>
            </div>
        </div>
        <div class="section-content" id="claude-evaluation-content">
            <!-- Claudeè©•ä¾¡çµæœãŒã“ã“ã«å‹•çš„ã«è¡¨ç¤ºã•ã‚Œã‚‹ -->
            <div class="evaluation-placeholder">
                <div class="empty-message">
                    <h4>ğŸ§  Claudeè©•ä¾¡</h4>
                    <p>è©•ä¾¡ãŒã¾ã å®Ÿè¡Œã•ã‚Œã¦ã„ã¾ã›ã‚“</p>
                    <p class="text-muted">ã€Œå†è©•ä¾¡ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ã€Claudeã«ã‚ˆã‚‹è©•ä¾¡ãŒå®Ÿè¡Œã•ã‚Œã¾ã™ã€‚</p>
                </div>
            </div>
        </div>
    </div>

    <!-- å·®åˆ†è¡¨ç¤ºãƒœã‚¿ãƒ³ã¨ãƒ‘ãƒãƒ« -->
    <div class="diff-display-section">
        <div class="diff-display-header">
            <h3>ğŸ” æ§‹æˆå·®åˆ†</h3>
            <div class="diff-display-actions">
                <button id="toggle-diff-btn" class="btn btn-sm btn-outline-primary" onclick="toggleDiffPanel()">
                    å·®åˆ†ã‚’è¡¨ç¤º ğŸ”
                </button>
            </div>
        </div>
        <!-- å·®åˆ†ãƒ‘ãƒãƒ«ï¼ˆåˆæœŸã¯éè¡¨ç¤ºï¼‰ -->
        <div id="diff-panel" class="diff-panel hidden">
            {% if structure and structure.diff_html %}
                <div class="diff-content">
                    {{ structure.diff_html | safe }}
                </div>
            {% else %}
                <div class="diff-placeholder">
                    <div class="diff-placeholder-icon">ğŸ”</div>
                    <div class="diff-placeholder-text">
                        <h4>å·®åˆ†ãŒæœªç”Ÿæˆã§ã™</h4>
                        <p>Geminiè£œå®Œå®Ÿè¡Œå¾Œã«å·®åˆ†ãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã™ã€‚</p>
                        <p class="text-muted">Claudeè©•ä¾¡ã¨Geminiè£œå®Œã®å·®åˆ†ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p>
                    </div>
                </div>
            {% endif %}
        </div>
    </div>

    <!-- ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å·®åˆ†è¡¨ç¤ºãƒœã‚¿ãƒ³ã¨ãƒ‘ãƒãƒ« -->
    <div class="module-diff-display-section">
        <div class="module-diff-display-header">
            <h3>ğŸ” ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å·®åˆ†</h3>
            <div class="module-diff-display-actions">
                <button id="toggle-module-diff-btn" class="btn btn-sm btn-outline-primary" onclick="toggleModuleDiffPanel()">
                    ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å·®åˆ†ã‚’è¡¨ç¤º ğŸ”
                </button>
            </div>
        </div>
        <!-- ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å·®åˆ†ãƒ‘ãƒãƒ«ï¼ˆåˆæœŸã¯éè¡¨ç¤ºï¼‰ -->
        <div id="module-diff-panel" class="module-diff-panel hidden">
            <div id="module-diff-container" class="module-diff-container">
                <div class="module-diff-header">
                    <h3 class="module-diff-title">ğŸ” ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å·®åˆ†</h3>
                    <div class="module-diff-summary">
                        <span class="diff-summary-item">ãƒ‡ãƒ¼ã‚¿ãªã—</span>
                    </div>
                </div>
                <div class="module-diff-content">
                    <div class="diff-section no-changes-section">
                        <div class="no-changes-message">
                            <span class="no-changes-icon">ğŸ“‹</span>
                            <h4 class="no-changes-title">å·®åˆ†ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</h4>
                            <p class="no-changes-description">
                                Claudeæ§‹æˆã¨Geminiè£œå®Œã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å·®åˆ†ã‚’æ¯”è¼ƒã—ã¦ãã ã•ã„ã€‚
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- å·®åˆ†è¡¨ç¤ºã‚¨ãƒªã‚¢ -->
    <div class="diff-pane" id="diff-pane">
        <div class="diff-header">
            <h3>ğŸ” æ§‹æˆå·®åˆ†</h3>
            <div class="diff-actions">
                <button class="btn btn-sm btn-outline-secondary" onclick="toggleDiffPane()">
                    <span id="diff-toggle-icon">â–¼</span>
                </button>
            </div>
        </div>
        <div class="diff-content" id="diff-content">
            <div class="diff-placeholder">
                <div class="diff-placeholder-icon">ğŸ”</div>
                <div class="diff-placeholder-text">
                    <h4>æ§‹æˆå·®åˆ†</h4>
                    <p>Claudeè©•ä¾¡ã¨Geminiè£œå®Œã®å·®åˆ†ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p>
                    <p class="text-muted">Geminiè£œå®Œå®Ÿè¡Œå¾Œã«å·®åˆ†ãŒè‡ªå‹•è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p>
                </div>
            </div>
        </div>
    </div>

    <!-- å±¥æ­´ä¸€è¦§è¡¨ç¤ºã‚¨ãƒªã‚¢ -->
    <div class="history-pane" id="history-pane">
        <div class="history-header">
            <h3>ğŸ“‹ è©•ä¾¡å±¥æ­´</h3>
            <div class="history-actions">
                <button class="btn btn-sm btn-outline-primary" onclick="refreshHistoryList()">
                    ğŸ”„ æ›´æ–°
                </button>
                <button class="btn btn-sm btn-outline-secondary" onclick="toggleHistoryPane()">
                    <span id="history-toggle-icon">â–¼</span>
                </button>
            </div>
        </div>
        <div class="history-content" id="history-content">
            <div class="history-placeholder">
                <div class="history-placeholder-icon">ğŸ“‹</div>
                <div class="history-placeholder-text">
                    <h4>è©•ä¾¡å±¥æ­´</h4>
                    <p>Claudeè©•ä¾¡ã¨Geminiè£œå®Œã®å±¥æ­´ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p>
                    <p class="text-muted">ã€Œæ›´æ–°ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨å±¥æ­´ã‚’èª­ã¿è¾¼ã¿ã¾ã™ã€‚</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Geminiè£œå®Œå±¥æ­´è¡¨ç¤ºã‚¨ãƒªã‚¢ -->
    <div class="completion-history-pane" id="completion-history-pane">
        <div class="completion-history-header">
            <h3>âœ¨ Geminiè£œå®Œå±¥æ­´</h3>
            <div class="completion-history-actions">
                <select id="completion-history-select" class="form-select form-select-sm" onchange="selectCompletionHistory(this.value)">
                    <option value="">æœ€æ–°ã®è£œå®Œ</option>
                </select>
                <button class="btn btn-sm btn-outline-secondary" onclick="toggleCompletionHistoryPane()">
                    <span id="completion-history-toggle-icon">â–¼</span>
                </button>
            </div>
        </div>
        <div class="completion-history-content" id="completion-history-content">
            <!-- å±¥æ­´é¸æŠæ™‚ã®è¡¨ç¤ºã‚¨ãƒªã‚¢ -->
            <div class="completion-history-placeholder">
                <div class="empty-message">
                    <h4>ğŸ¨ Geminiè£œå®Œå±¥æ­´</h4>
                    <p>Geminiè£œå®Œå±¥æ­´ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p>
                    <p class="text-muted">ä¸Šè¨˜ã®ã‚»ãƒ¬ã‚¯ãƒˆãƒœãƒƒã‚¯ã‚¹ã‹ã‚‰å±¥æ­´ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Geminiè£œå®Œçµæœè¡¨ç¤ºã‚¨ãƒªã‚¢ï¼ˆå¾“æ¥ã®è¡¨ç¤ºï¼‰ -->
    <div class="output-pane" id="output-pane">
        <div class="output-header">
            <h3>âœ¨ Geminiè£œå®Œçµæœ</h3>
            <button class="btn btn-sm btn-outline-secondary" onclick="toggleOutputPane()">
                <span id="output-toggle-icon">â–¼</span>
            </button>
        </div>
        <div class="output-content" id="completion-content">
            {% if structure and structure.gemini_output %}
                {% if structure.gemini_output.status == "success" %}
                    <div class="completion-success">
                        <h4>âœ¨ Geminiè£œå®Œå®Œäº†</h4>
                        <div class="completion-content">
                            <pre>{{ structure.gemini_output.content }}</pre>
                        </div>
                    </div>
                {% elif structure.gemini_output.status == "failed" %}
                    <div class="completion-error">
                        <h4>âš ï¸ Geminiè£œå®Œå¤±æ•—</h4>
                        <p>{{ structure.gemini_output.reason }}</p>
                        {% if structure.gemini_output.error_details %}
                            <details>
                                <summary>ã‚¨ãƒ©ãƒ¼è©³ç´°</summary>
                                <pre>{{ structure.gemini_output.error_details }}</pre>
                            </details>
                        {% endif %}
                    </div>
                {% endif %}
            {% else %}
                <div class="empty-supplemental">
                    <div class="empty-message">
                        <h4>ğŸ¨ Geminiè£œå®Œ</h4>
                        <p>Geminiè£œå®Œã¯ã¾ã ç”Ÿæˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</p>
                        <p class="text-muted">ã€ŒUIã‚’ç”Ÿæˆã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ã€ã“ã“ã«Geminiã®è£œå®ŒçµæœãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p>
                    </div>
                </div>
            {% endif %}
        </div>
    </div>

    <!-- Geminiå‡ºåŠ›ã‚³ãƒ³ãƒ†ãƒŠï¼ˆGeminiParserç”¨ï¼‰ -->
    <div id="gemini-output" style="display: block !important; width: 100%; min-width: 300px; background: #f7f7f7; border-left: 1px solid #ccc; padding: 1rem; overflow-y: auto; position: relative; z-index: 10; visibility: visible !important; opacity: 1 !important;">
        <!-- GeminiParserãŒã“ã“ã«å‡ºåŠ›ã—ã¾ã™ -->
        <div class="gemini-output-placeholder" style="display: flex !important;">
            <div class="placeholder-icon">âœ¨</div>
            <div class="placeholder-text">
                <h4>ğŸ¨ Geminiè£œå®Œçµæœ</h4>
                <p>Geminiè£œå®Œã¯ã¾ã å®Ÿè¡Œã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</p>
                <p class="text-muted">ãƒãƒ£ãƒƒãƒˆã§ã€ŒUIã‚’ç”Ÿæˆã—ã¦ãã ã•ã„ã€ã¨å…¥åŠ›ã™ã‚‹ã¨ã€ã“ã“ã«Geminiã®è£œå®ŒçµæœãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p>
                <div class="placeholder-actions">
                    <button class="btn btn-sm btn-primary" onclick="suggestGeminiCompletion()">
                        ğŸš€ Geminiè£œå®Œã‚’ææ¡ˆ
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- è£œåŠ©æƒ…å ±ã‚¨ãƒªã‚¢ -->
    <div class="reference-area">
        <div class="reference-header">
            <h3>ğŸ“š å‚è€ƒæƒ…å ±</h3>
        </div>
        <div class="reference-content">
            <div class="quick-actions">
                <h4>ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</h4>
                <div class="action-buttons">
                    <button class="btn btn-sm btn-outline-primary" onclick="suggestTemplate('web')">
                        ğŸŒ Webã‚¢ãƒ—ãƒª
                    </button>
                    <button class="btn btn-sm btn-outline-primary" onclick="suggestTemplate('mobile')">
                        ğŸ“± ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒª
                    </button>
                    <button class="btn btn-sm btn-outline-primary" onclick="suggestTemplate('api')">
                        ğŸ”Œ APIè¨­è¨ˆ
                    </button>
                </div>
            </div>
            
            <div class="help-section">
                <h4>ğŸ’¡ ä½¿ã„æ–¹ãƒ’ãƒ³ãƒˆ</h4>
                <ul>
                    <li>å…·ä½“çš„ãªè¦ä»¶ã‚’ä¼ãˆã‚‹ã¨ã€ã‚ˆã‚Šè‰¯ã„æ§‹æˆãŒç”Ÿæˆã•ã‚Œã¾ã™</li>
                    <li>ã€ŒJSONå½¢å¼ã§å‡ºåŠ›ã—ã¦ãã ã•ã„ã€ã¨æ˜ç¤ºã™ã‚‹ã¨ç¢ºå®Ÿã§ã™</li>
                    <li>æ§‹æˆãŒæ°—ã«å…¥ã‚‰ãªã„å ´åˆã¯ã€Œä¿®æ­£ã—ã¦ãã ã•ã„ã€ã¨ä¼ãˆã¦ãã ã•ã„</li>
                </ul>
            </div>
            
            <div class="status-info">
                <h4>ğŸ“Š ç¾åœ¨ã®çŠ¶æ…‹</h4>
                <div class="status-item">
                    <span class="status-label">æ§‹æˆç”Ÿæˆ:</span>
                    <span class="status-value">
                        {% if structure and structure.content %}
                            âœ… å®Œäº†
                        {% else %}
                            â³ æœªç”Ÿæˆ
                        {% endif %}
                    </span>
                </div>
                <div class="status-item">
                    <span class="status-label">Claudeè©•ä¾¡:</span>
                    <span class="status-value">
                        {% if structure and structure.evaluation %}
                            âœ… å®Œäº†
                        {% else %}
                            â³ æœªå®Ÿè¡Œ
                        {% endif %}
                    </span>
                </div>
                <div class="status-item">
                    <span class="status-label">Geminiè£œå®Œ:</span>
                    <span class="status-value">
                        {% if structure and structure.gemini_output %}
                            âœ… å®Œäº†
                        {% else %}
                            â³ æœªå®Ÿè¡Œ
                        {% endif %}
                    </span>
                </div>
            </div>
        </div>
    </div>
</div> 
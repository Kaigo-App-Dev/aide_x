{% extends "base.html" %}

{% block content %}
<div class="container mt-4">

  <!-- ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ -->
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        <div class="alert alert-{{ category }} mt-3">{{ message }}</div>
      {% endfor %}
    {% endif %}
  {% endwith %}

  <!-- ã‚¿ã‚¤ãƒˆãƒ« -->
  <h2>ğŸ” ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼: {{ structure.title }}</h2>

  <!-- è©•ä¾¡çµæœ -->
  {% if structure.evaluation %}
    <div class="alert alert-info mt-3">
      <strong>ğŸ§  è©•ä¾¡çµæœï¼š</strong><br>
      ä¸€è‡´åº¦ï¼š{{ structure.evaluation.intent_match }}%ã€å“è³ªã‚¹ã‚³ã‚¢ï¼š{{ structure.evaluation.quality_score }}%<br>
      ç†ç”±ï¼š{{ structure.evaluation.intent_reason }}
    </div>
  {% endif %}

  <!-- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”¨ãƒ•ã‚©ãƒ¼ãƒ  -->
  <form method="post" action="{{ url_for('preview.submit_structure', structure_id=structure.id) }}">
  {% for section in structure.sections %}
    <div class="mb-3">
      <label class="form-label">{{ section.label }}</label>

      {% if section.type == "text" %}
        <input type="text" class="form-control" name="{{ section.name }}">

      {% elif section.type == "textarea" %}
        <textarea class="form-control" name="{{ section.name }}"></textarea>

      {% elif section.type == "radio" %}
        {% for option in section.options %}
          <div class="form-check form-check-inline">
            <input class="form-check-input" type="radio" name="{{ section.name }}" id="{{ section.name }}_{{ loop.index }}" value="{{ option }}">
            <label class="form-check-label" for="{{ section.name }}_{{ loop.index }}">{{ option }}</label>
          </div>
        {% endfor %}

      {% elif section.type == "select" %}
        <select class="form-select" name="{{ section.name }}">
          {% for option in section.options %}
            <option value="{{ option }}">{{ option }}</option>
          {% endfor %}
        </select>

      {% elif section.type == "checkbox" %}
        <div class="form-check">
          <input class="form-check-input" type="checkbox" name="{{ section.name }}" id="{{ section.name }}">
          <label class="form-check-label" for="{{ section.name }}">{{ section.label }}</label>
        </div>

      {% elif section.type == "date" %}
        <input type="date" class="form-control" name="{{ section.name }}">

      {% elif section.type == "number" %}
        <input type="number" class="form-control" name="{{ section.name }}">

      {% elif section.type == "file" %}
        <input type="file" class="form-control" name="{{ section.name }}">

      {% else %}
        <input type="text" class="form-control" name="{{ section.name }}">
      {% endif %}
    </div>
  {% endfor %}

  <!-- ğŸ”½ ã“ã“ãŒæ–°ãŸã«è¿½åŠ ã•ã‚Œã‚‹é€ä¿¡ãƒœã‚¿ãƒ³ -->
  <button type="submit" class="btn btn-primary mt-3">âœ… å…¥åŠ›ã‚’é€ä¿¡</button>
</form>

  <a href="{{ url_for('structure.edit_structure', structure_id=structure.id) }}" class="btn btn-secondary mt-3">â† ç·¨é›†ç”»é¢ã«æˆ»ã‚‹</a>
</div>
{% endblock %}
